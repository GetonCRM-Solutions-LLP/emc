<template>
    <c-file-upload-spinner show-spinner={isSpinner}></c-file-upload-spinner>
    <template if:true={promiseError}>
        <c-m-burse-error message={errorMessage}></c-m-burse-error>
    </template>
    <div class="transition"  if:true={isUploadShow}>
            <div>
                <c-m-burse-header-text head-text="Step 2 - Upload Insurance"></c-m-burse-header-text>
            </div>
            <div class="slds-text-heading_small slds-text-align_center slds-p-bottom_x-large font-style">Please <strong>upload your
                    Insurance Declaration Page</strong><br/>
                not your Insurance Card.
            </div>
            <div class="m-left m-right">
                <form class="box has-advanced-upload" enctype="multipart/form-data" method="post" action=""  ondragover={onDrag} ondragleave={onDragLeave}  ondrop={handleDropFile}>
                    <div 
                        class="box__input" id="box__input">
                        <div class="box__img" if:true={isVisible}>
                            <img   src={uploaded} >
                        </div>
                        <svg height="43" viewBox="0 0 566.93 566.93" width="50" class="box__icon" if:false={isVisible}>
                            <path class="b"
                                d="M51.12,332.94c-10.67,.11-20.45,9.83-20.24,20.47v139.22c0,10.57,9.64,20.18,20.24,20.18h464.68c10.59,0,20.24-9.62,20.24-20.18v-139.22c.16-10.67-9.54-20.47-20.24-20.47s-20.39,9.8-20.24,20.47v119.03H71.36v-119.03c.24-10.78-9.43-20.58-20.24-20.47Z">
                            </path>
                            <path class="b"
                                d="M283.44,38.12c-4.82,.18-10.41,2.19-13.91,5.48l-114.67,107.93c-6.56,7.32-9.27,21.34-1.69,29.51,7.48,8.06,22,7.8,29.51-.21l80.53-75.89V394.14c0,11.17,9.06,20.24,20.24,20.24s20.24-9.06,20.24-20.24V104.94l80.53,75.89c6.93,6.9,21.95,8.19,29.51,.21,7.56-7.96,5.14-22.5-1.69-29.51l-114.67-107.93c-3.93-3.69-8.54-5.48-13.91-5.48h0Z">
                            </path>
                        </svg>
                        <div class="box__container slds-btn slds-btn-primary slds-btn-sm waves-effect bc-blue waves-light" if:false={isVisible}>
                            <span>Choose file to upload</span>
                            <input accept="application/pdf"
                            class="box__file" id="file" name="file" type="file" onchange={fileChanged}/>
                        </div>
                        <div class="box__upload"  if:true={isVisible}>
                            <button class="slds-btn slds-btn-reverse slds-btn-sm waves-effect bc-blue waves-light" onclick={uploadFileInChunk}>
                                Upload
                            </button>
                        </div>
                        <div>
                            <label class="w-100 text-center pd-10 file-message" for="file">{fileName}
                                <span style="color: #8b8686; margin-left: 14px;">{fSize}</span>
                            </label>
                            <label class="w-100 text-center error-text" for="file-error" if:true={isError}>
                                <i class="fa-solid fa-circle-exclamation"></i>  {errorUploading}
                            </label>
                        </div>
                    </div>
                    <span class="box__dragndrop slds-align_absolute-center"> or drag and drop files here</span>
                </form>
            </div>
        
            <div class="slds-clearfix slds-p-top_x-large m-left m-right">
                <!-- <div class="insurance-text slds-p-bottom_small font-color"><strong>Make sure your insurance information includes your name, insured vehicle, level of insurance,
                        and coverage dates.</strong>
                </div> -->
                <div class="footer-text slds-float_left">
                    <div class="font-color"><strong>Your company insurance minimums are:</strong>
                        <table class="slds-m-top_x-small">
                            <tbody>
                            <tr>
                                <td>Bodily Injury</td>
                                <td>${client.bodilyInjury}</td>
                            </tr>
                            <tr>
                                <td>Uninsured Motorist</td>
                                <td>${client.unInsuranceMotorist}</td>
                            </tr>
                            <tr>
                                <td>Property Damage</td>
                                <td>$<lightning-formatted-number value={client.propertyDamage}></lightning-formatted-number></td>
                            </tr>
                            <tr>
                                <td>Comprehensive Deductible</td>
                                <td>$<lightning-formatted-number value={client.comprehensive}></lightning-formatted-number></td>
                            </tr>
                            <tr>
                                <td>Collision Deductible</td>
                                <td>$<lightning-formatted-number value={client.collision}></lightning-formatted-number></td>
                            </tr>
                            <tr if:true={client.umbrella}>
                                <td>Umbrella Coverage</td>
                                <td>$<lightning-formatted-number value={client.umbrella}></lightning-formatted-number></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="footer-button slds-float_right mright-0 mleft-0">
                    <template if:true={nextPacketShow}>
                        <button class="slds-btn slds-btn-primary slds-btn-sm waves-effect bc-blue waves-light"
                            onclick={nextDriverPacket} if:false={isVisible}>
                            Next Sign Driver Packet
                        </button>
                    </template>
                    <div class="back_to_previous" if:true={isVisible}>
                        <a class="font-s" onclick={backToPage}><i class="fa-solid fa-angle-left"></i> Back</a>
                    </div>
                    <div  if:false={isVisible}>
                        <div class="back_to_previous slds-float_left">
                            <a class="font-ms" onclick={backToPrevious}><i class="fa-solid fa-angle-left"></i> Back</a>
                        </div>
                        <div class="back_to_previous marginl-px slds-float_right" if:false={nextShow}>
                            <a class="font-ms" onclick={skipToPage}>Skip<i class="fa-solid fa-angle-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
    </div>

    <div class="transition modal-content" if:true={isUploaded}>
        <div class="slds-text-heading_large slds-text-align_center slds-p-top_xx-large slds-p-bottom_x-large font-style">
            Thank you for uploading your insurance.
        </div>
        <div class="slds-text-heading_medium slds-text-align_center slds-p-bottom_x-large font-style font-width">
           A team member will review your insurance shortly and contact you with any questions.
        </div>
        <div class="footer-button slds-text-align_center">
            <button class="slds-btn slds-btn-primary slds-btn-done waves-effect bc-blue waves-light"
                        onclick={nextDoneUpload}>
                        Done
            </button>
        </div>
    </div>

    <div class="transition" if:true={isUploadSkip}>
        <div>
            <c-m-burse-header-text head-text="Step 2 - Insurance Declaration Upload"></c-m-burse-header-text>
        </div>
        <div class="m-left m-right p_top">
            <lightning-layout horizontal-align="space">
                <lightning-layout-item padding="around-large" size="5"  class="custom-box">
                    <div>
                        <div class="slds-p-bottom_x-small font"><strong>You can upload your insurance at a later date:</strong></div>
                        <ul class="slds-list_dotted font-color">
                            <li>Here in the portal</li>
                            <li>By providing the documentation to your plan administrator</li>
                            <li>By sending them to Driver Services</li>
                        </ul>
                    </div>
                </lightning-layout-item>
                <lightning-layout-item class="slds-var-p-around_x-large">
                    <div>
                        <div class="slds-size_8-of-12 slds-p-bottom_small right-text">You have 30 days from today to submit your vehicle car insurance documentation.</div>
                        <div class="slds-size_8-of-12 slds-p-bottom_small right-text">If you do not submit your insurance information you will forfeit your fixed amount (car allowance) until you do so.</div>
                    </div>
                </lightning-layout-item>
            </lightning-layout>
        </div>
      
        <div class="slds-clearfix slds-p-top_x-large m-left m-right">
            <div class="footer-button slds-float_right mright-0 mleft-0">
                <template if:false={packet}>
                    <button class="slds-btn slds-btn-primary slds-btn-sm waves-effect bc-blue waves-light"
                        onclick={nextDriverPacket}>
                        Next Sign Driver Packet
                    </button>
                </template>
                <template if:true={packet}>
                    <template if:false={dPacket}>
                        <button class="slds-btn slds-btn-primary slds-btn-sm waves-effect bc-blue waves-light"
                            onclick={nextmLog}>
                            Next mLog Preview
                        </button>
                    </template>
                    <template if:true={dPacket}>
                        <button class="slds-btn slds-btn-primary slds-btn-sm waves-effect bc-blue waves-light" onclick={redirectToDashboard}>
                            {renderText}
                        </button>
                    </template>
                </template>
                <div>
                    <div class="back_to_previous slds-float_left">
                        <a class="font-ms" onclick={backToPrevious}><i class="fa-solid fa-angle-left"></i> <span>  Back</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>